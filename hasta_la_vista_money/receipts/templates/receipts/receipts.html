{% extends 'base.html' %}
{% load i18n %}
{% load django_bootstrap5 %}
{% load static %}



{% block content %}
    <title>Список чеков</title>

    <div class="container">
        <div class="display-4 text-center pt-3 text-light">
            Список чеков
        </div>
        <div class="row ">
            <div class="col">
                <form class="text-light" method="get" id="filter-form">
                    {% csrf_token %}
                    {% bootstrap_field filter.form.name_seller %}
                    {% bootstrap_field filter.form.receipt_date %}
                    {% bootstrap_button 'Search' button_type='submit' button_class='btn btn-primary' %}
                </form>
            </div>
        </div>
        <div class="row mt-5 justify-content-center">
            <div class="link-wrapper p-0">
                <a class="link-application btn btn-outline-warning" href="{% url 'applications:list' %}">Вернуться на страницу с приложениями</a>
                <a class="add-receipt-button btn btn-outline-danger" href="{% url 'receipts:create' %}">Добавить чек вручную</a>
            </div>
            {% for receipt in receipts %}
            <div class="receipt bg-light rounded-3 m-1">
                <form  action="" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="receipt_id" value="{{ receipt.id }}">
                    <button class="remove-button" type="submit" onclick="return confirm('Вы уверены, что хотите удалить этот чек?');" name="delete_button">
                        <span class="top"></span>
                        <span class="bot"></span>
                    </button>
                </form>

                <table>
                  <thead>
                      <tr>
                          <th><h4>Продавец: {{ receipt.customer.name_seller }}</h4></th>
                          <th>Дата и время: {{ receipt.receipt_date | date:"d.m.Y H:i" }}</th>
                          <th>Итоговая сумма: {{ receipt.total_sum }}</th>
                      </tr>
                      <tr>
                          <th>Наименование товара</th>
                          <th>Цена</th>
                          <th>Количество</th>
                          <th>Сумма</th>
                      </tr>
                  </thead>
                  <tbody>
                    {% for product in receipt.product.all %}
                    <tr>
                      <td>{{ product.product_name }}</td>
                      <td>{{ product.price }}</td>
                      <td>{{ product.quantity }}</td>
                      <td>{{ product.amount }}</td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
            </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}