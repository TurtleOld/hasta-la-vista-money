# Управление расходами

Раздел расходов в приложении "Hasta la Vista, Money!" позволяет пользователям вести учет своих трат, создавать категории расходов и анализировать свои финансовые привычки.

## Обзор функциональности

### Основные возможности

- **Добавление расходов** - создание записей о потраченных средствах
- **Категоризация** - организация расходов по категориям и подкатегориям
- **Фильтрация** - поиск расходов по различным критериям
- **Аналитика** - просмотр статистики по месяцам и категориям
- **Копирование** - быстрое создание похожих расходов

### Структура данных

Каждый расход содержит следующую информацию:

- **Сумма** - потраченная сумма в рублях
- **Категория** - тип расхода (например, "Продукты", "Транспорт")
- **Счет** - источник средств для расхода
- **Дата и время** - когда произошел расход
- **Пользователь** - владелец записи

## Интерфейс

### Главная страница расходов

Главная страница отображает:

- **Список расходов** с пагинацией
- **Фильтры** для поиска по категориям, счетам и датам
- **Форма добавления** нового расхода
- **Дерево категорий** для навигации

### Фильтрация

Доступны следующие фильтры:

- **По категории** - выбор конкретной категории расходов
- **По счету** - фильтр по источнику средств
- **По дате** - выбор периода (от и до)

### Сортировка

Расходы автоматически сортируются по дате (новые сверху).

## Категории расходов

### Иерархическая структура

Категории расходов поддерживают иерархическую структуру:

```text
ЖКХ
├── Электричество
├── Вода
└── Отопление

Продукты
├── Молочные продукты
├── Мясо
└── Овощи и фрукты
```

### Управление категориями

#### Создание категории

1. Перейдите в раздел "Категории расходов"
2. Нажмите "Добавить категорию"
3. Заполните название
4. Выберите родительскую категорию (опционально)
5. Сохраните

#### Удаление категории

- Категории можно удалять только если в них нет расходов
- При удалении родительской категории подкатегории становятся корневыми

## Добавление расходов

### Через веб-интерфейс

1. На главной странице расходов найдите форму "Добавить расход"
2. Выберите категорию из выпадающего списка
3. Выберите счет для списания
4. Введите сумму
5. Укажите дату и время
6. Нажмите "Добавить"

### Валидация

Система проверяет:

- **Достаточность средств** - сумма не должна превышать баланс счета
- **Обязательность полей** - все поля должны быть заполнены
- **Корректность даты** - дата не может быть в будущем

## Редактирование расходов

### Изменение данных

1. Найдите нужный расход в списке
2. Нажмите на кнопку "Изменить"
3. Внесите необходимые изменения
4. Сохраните

### Автоматическое пересчитывание

При изменении счета или суммы система автоматически:

- Возвращает старую сумму на исходный счет
- Списывает новую сумму с выбранного счета
- Обновляет балансы счетов

## Копирование расходов

### Быстрое копирование

1. Найдите расход для копирования
2. Нажмите кнопку "Копировать"
3. Система создаст копию с теми же данными
4. Перейдите к редактированию копии

### Использование

Копирование полезно для:

- Регулярных расходов (например, оплата услуг)
- Похожих покупок
- Создания шаблонов

## Удаление расходов

### Процедура удаления

1. Найдите расход в списке
2. Нажмите кнопку "Удалить"
3. Подтвердите действие
4. Система вернет сумму на счет

### Ограничения

- Удаленные расходы нельзя восстановить
- При удалении автоматически восстанавливается баланс счета

## Аналитика и отчеты

### Месячная статистика

Система автоматически группирует расходы по месяцам и показывает:

- Общую сумму расходов за месяц
- Количество записей
- Среднюю сумму на запись

### По категориям

Доступна статистика по категориям:

- Сумма расходов по каждой категории
- Процент от общих расходов
- Тренды по месяцам

### Интеграция с чеками

Расходы автоматически интегрируются с системой чеков:

- Покупки по чекам отображаются как отдельная категория
- Суммы из чеков учитываются в общей статистике
- Поддерживается группировка по месяцам

## API и интеграции

### REST API

Доступны следующие эндпоинты:

- `GET /api/expenses/` - список расходов
- `POST /api/expenses/` - создание расхода
- `PUT /api/expenses/{id}/` - обновление расхода
- `DELETE /api/expenses/{id}/` - удаление расхода

### Форматы данных

Поддерживаются форматы:

- JSON для API запросов
- CSV для экспорта данных
- PDF для отчетов

## Настройки и конфигурация

### Пользовательские настройки

- **Валюта** - выбор валюты для отображения (по умолчанию рубли)
- **Часовой пояс** - настройка временной зоны
- **Формат даты** - предпочтительный формат отображения дат

### Системные ограничения

- **Максимальная глубина категорий** - 3 уровня
- **Максимальная сумма** - 999,999,999.99
- **Количество записей на странице** - 10 (настраивается)

## Безопасность

### Права доступа

- Пользователи видят только свои расходы
- Администраторы имеют доступ ко всем данным
- API требует аутентификации

### Валидация данных

- Все входные данные проверяются на корректность
- Защита от SQL-инъекций
- Валидация на стороне клиента и сервера

## Устранение неполадок

### Частые проблемы

#### "Недостаточно средств на счете"

**Причина:** Попытка создать расход на сумму, превышающую баланс счета.

**Решение:**

- Пополните счет
- Уменьшите сумму расхода
- Выберите другой счет

#### "Категория не найдена"

**Причина:** Категория была удалена или переименована.

**Решение:**

- Выберите другую категорию
- Создайте новую категорию
- Обратитесь к администратору

#### "Ошибка при сохранении"

**Причина:** Проблемы с подключением к базе данных или валидацией.

**Решение:**

- Проверьте подключение к интернету
- Обновите страницу
- Попробуйте позже

### Логи и отладка

Для диагностики проблем используются:

- Логи приложения в консоли браузера
- Серверные логи
- API ответы с кодами ошибок

## Обновления и новые функции

### Планируемые улучшения

- **Мобильное приложение** - нативная поддержка iOS и Android
- **Умные категории** - автоматическая категоризация по описанию
- **Бюджетирование** - установка лимитов по категориям
- **Экспорт в Excel** - расширенная поддержка форматов
- **Интеграция с банками** - автоматический импорт транзакций

### Обратная связь

Для предложений и сообщений об ошибках:

- Создайте issue в GitHub репозитории
